<div class="background">
	<div class="subBackground">
	</div>
</div>
<form method="post" action="setting">
	<input type="hidden" name="scrollPos" id="scrollPos" value="0"/>
	<div class="body">
		<h1>Settings</h1>
		<div class="graphContainer">
			<div class="graphSubContainer graphSubContainer00">
				<input type="radio" name="radio-btn00" id="graph-0_00" checked />
				<div id="graph_00_00" class="graph">
					<label for="graph-2_00" class="prev"><div class="arrow">&#10096;</div></label>
					<div class="containerChart">
						<div class="titleChart">Results by keyword</div>
						<div class="bar-chart">
							<ul class="axis-y">
								<li data-axisy="100"></li>
								<li data-axisy="75"></li>
								<li data-axisy="50"></li>
								<li data-axisy="25"></li>
								<li data-axisy="0"></li>
							</ul>
							<ul class="axis-x">
								<li title="Ours : &#10;500 results"><i>Ours</i></li>
								<li title="Neutron : &#10;445 results"><i>Neutron</i></li>
								<li title="Chien Vert : &#10;670 results"><i>Chien Vert</i></li>
								<li title="wikileaks : &#10;205 results"><i>wikileaks</i></li>
								<li title="nucléaire : &#10;450 results"><i>nucléaire</i></li>
								<li title="Test : &#10;825 results"><i>Test</i></li>
								<li title=":All : &#10;420 results"><i>:All</i></li>
								<li title="Rat-thon : &#10;600 results"><i>Rat-thon</i></li>
							</ul>
						</div>
					</div>
					<label for="graph-1_00" class="next"><div class="arrow">&#10097;</div></label>
				</div>
				<input type="radio" name="radio-btn00" id="graph-1_00" />
				<div id="graph_00_01" class="graph">
					<label for="graph-0_00" class="prev"><div class="arrow">&#10096;</div></label>
					<div class="containerChart">
						<div class="titleChart">Distribution of results by source</div>
						<div class="torChart">
							<div class="circle">
								<div class="source1">
									<div title="Nextinpact :&#10;65%" class="s1"></div>
								</div>
								<div class="source2">
									<div title="Les crises :&#10;35%" class="s2"></div>
								</div>
								<div class="source3">
									<div title="Numerama :&#10;15%" class="s3"></div>
								</div>
								<div class="source4">
									<div title="Le monde :&#10;20%" class="s4"></div>
								</div>
							</div>
							<div class="center"></div>
						</div>
					</div>
					<label for="graph-2_00" class="next"><div class="arrow">&#10097;</div></label>
				</div>
				<input type="radio" name="radio-btn00" id="graph-2_00" />
				<div id="graph_00_02" class="graph">
					<label for="graph-1_00" class="prev"><div class="arrow">&#10096;</div></label>
					<div class="containerChart">
						<div class="titleChart">Results by query</div>
						<div class="bar-chart">
							<ul class="axis-y">
								<li data-axisy="100"></li>
								<li data-axisy="75"></li>
								<li data-axisy="50"></li>
								<li data-axisy="25"></li>
								<li data-axisy="0"></li>
							</ul>
							<ul class="axis-x">
								<li title="Query00 : &#10;570 results"><i>Query00</i></li>
								<li title="Query01 : &#10;885 results"><i>Query01</i></li>
								<li title="Query02 : &#10;400 results"><i>Query02</i></li>
								<li title="Query03 : &#10;290 results"><i>Query03</i></li>
								<li title="Query04 : &#10;680 results"><i>Query04</i></li>
								<li title="Query05 : &#10;885 results"><i>Query05</i></li>
								<li title="Query06 : &#10;520 results"><i>Query06</i></li>
								<li title="Query07 : &#10;620 results"><i>Query07</i></li>
							</ul>
						</div>
					</div>
					<label for="graph-0_00" class="next"><div class="arrow">&#10097;</div></label>
				</div>
			</div>
			<div class="graphSubContainer graphSubContainer01">
				<input type="radio" name="radio-btn01" id="graph-0_01" checked />
				<div id="graph_01_00" class="graph">
					<label for="graph-2_01" class="prev"><div class="arrow">&#10096;</div></label>
					<div class="containerChart">
						<div class="titleChart">Results by query</div>
						<div class="bar-chart">
							<ul class="axis-y">
								<li data-axisy="100"></li>
								<li data-axisy="75"></li>
								<li data-axisy="50"></li>
								<li data-axisy="25"></li>
								<li data-axisy="0"></li>
							</ul>
							<ul class="axis-x">
								<li title="Query00 : &#10;570 results"><i>Query00</i></li>
								<li title="Query01 : &#10;885 results"><i>Query01</i></li>
								<li title="Query02 : &#10;400 results"><i>Query02</i></li>
								<li title="Query03 : &#10;290 results"><i>Query03</i></li>
								<li title="Query04 : &#10;680 results"><i>Query04</i></li>
								<li title="Query05 : &#10;885 results"><i>Query05</i></li>
								<li title="Query06 : &#10;520 results"><i>Query06</i></li>
								<li title="Query07 : &#10;620 results"><i>Query07</i></li>
							</ul>
						</div>
					</div>
					<label for="graph-1_01" class="next"><div class="arrow">&#10097;</div></label>
				</div>
				<input type="radio" name="radio-btn01" id="graph-1_01" />
				<div id="graph_01_01" class="graph">
					<label for="graph-0_01" class="prev"><div class="arrow">&#10096;</div></label>
					<div class="containerChart">
						<div class="titleChart">Number of results per query</div>
						<div class="backChart">
							<ul class="axis-y">
								<li data-axisy="100"></li>
								<li data-axisy="75"></li>
								<li data-axisy="50"></li>
								<li data-axisy="25"></li>
								<li data-axisy="0"></li>
							</ul>
							<ul class="axis-time">
								<li data-time="Mars"></li>
								<li data-time="Avril"></li>
								<li data-time="Mai"></li>
								<li data-time="Juin"></li>
								<li data-time="Juillet"></li>
								<li data-time="Août"></li>
							</ul>
							<div class="curveChart">
								<div class="curveChartPart">
									<div title="Query01 : 15 results in march" class="query01">
									</div>
									<div title="Query02" class="query02">
									</div>
									<div title="Query03" class="query03">
									</div>
								</div>
								<div class="curveChartPart">
									<div title="" class="query01">
									</div>
									<div title="" class="query02">
									</div>
									<div title="" class="query03">
									</div>
								</div>
								<div class="curveChartPart">
									<div title="" class="query01">
									</div>
									<div title="" class="query02">
									</div>
									<div title="" class="query03">
									</div>
								</div>
								<div class="curveChartPart">
									<div title="" class="query01">
									</div>
									<div title="" class="query02">
									</div>
									<div title="" class="query03">
									</div>
								</div>
								<div class="curveChartPart">
									<div title="" class="query01">
									</div>
									<div title="" class="query02">
									</div>
									<div title="" class="query03">
									</div>
								</div>
								<div class="curveChartPart">
									<div title="" class="query01">
									</div>
									<div title="" class="query02">
									</div>
									<div title="" class="query03">
									</div>
								</div>
							</div>
						</div>
					</div>
					<label for="graph-2_01" class="next"><div class="arrow">&#10097;</div></label>
				</div>
				<input type="radio" name="radio-btn01" id="graph-2_01" />
				<div id="graph_01_02" class="graph">
					<label for="graph-1_01" class="prev"><div class="arrow">&#10096;</div></label>
					<div class="containerChart">
						<div class="titleChart">Results read per query</div>
						<div class="torChart">
							<div class="circle">
								<div class="source1">
									<div title="Query01 :&#10;65% read" class="s1"></div>
								</div>
								<div class="source2">
									<div title="Query02 :&#10;35% read" class="s2"></div>
								</div>
								<div class="source3">
									<div title="Query03 :&#10;15% read" class="s3"></div>
								</div>
								<div class="source4">
									<div title="Query04 :&#10;20% read" class="s4"></div>
								</div>
							</div>
							<div class="center"></div>
						</div>
					</div>
					<label for="graph-0_01" class="next"><div class="arrow">&#10097;</div></label>
				</div>
			</div>
			<div class="graphSubContainer graphSubContainer02">
				<input type="radio" name="radio-btn02" id="graph-0_02" checked />
				<div id="graph_02_00" class="graph">
					<label for="graph-2_02" class="prev"><div class="arrow">&#10096;</div></label>
					<div class="containerChart">
						<div class="titleChart">Results by query</div>
						<div class="bar-chart">
							<ul class="axis-y">
								<li data-axisy="100"></li>
								<li data-axisy="75"></li>
								<li data-axisy="50"></li>
								<li data-axisy="25"></li>
								<li data-axisy="0"></li>
							</ul>
							<ul class="axis-x">
								<li title="Query00 : &#10;500 results"><i>Query00</i></li>
								<li title="Query01 : &#10;445 results"><i>Query01</i></li>
								<li title="Query02 : &#10;670 results"><i>Query02</i></li>
								<li title="Query03 : &#10;205 results"><i>Query03</i></li>
								<li title="Query04 : &#10;450 results"><i>Query04</i></li>
								<li title="Query05 : &#10;825 results"><i>Query05</i></li>
								<li title="Query06 : &#10;420 results"><i>Query06</i></li>
								<li title="Query07 : &#10;600 results"><i>Query07</i></li>
							</ul>
						</div>
					</div>
					<label for="graph-1_02" class="next"><div class="arrow">&#10097;</div></label>
				</div>
				<input type="radio" name="radio-btn02" id="graph-1_02" />
				<div id="graph_02_01" class="graph">
					<label for="graph-0_02" class="prev"><div class="arrow">&#10096;</div></label>
					<div class="containerChart">
						<div class="titleChart">Number of results per query</div>
						<div class="backChart">
							<ul class="axis-y">
								<li data-axisy="100"></li>
								<li data-axisy="75"></li>
								<li data-axisy="50"></li>
								<li data-axisy="25"></li>
								<li data-axisy="0"></li>
							</ul>
							<ul class="axis-time">
								<li data-time="Mars"></li>
								<li data-time="Avril"></li>
								<li data-time="Mai"></li>
								<li data-time="Juin"></li>
								<li data-time="Juillet"></li>
								<li data-time="Août"></li>
							</ul>
							<div class="curveChart">
								<div class="curveChartPart">
									<div title="Query01 : 15 results in march" class="query01">
									</div>
									<div title="Query02" class="query02">
									</div>
									<div title="Query03" class="query03">
									</div>
								</div>
								<div class="curveChartPart">
									<div title="" class="query01">
									</div>
									<div title="" class="query02">
									</div>
									<div title="" class="query03">
									</div>
								</div>
								<div class="curveChartPart">
									<div title="" class="query01">
									</div>
									<div title="" class="query02">
									</div>
									<div title="" class="query03">
									</div>
								</div>
								<div class="curveChartPart">
									<div title="" class="query01">
									</div>
									<div title="" class="query02">
									</div>
									<div title="" class="query03">
									</div>
								</div>
								<div class="curveChartPart">
									<div title="" class="query01">
									</div>
									<div title="" class="query02">
									</div>
									<div title="" class="query03">
									</div>
								</div>
								<div class="curveChartPart">
									<div title="" class="query01">
									</div>
									<div title="" class="query02">
									</div>
									<div title="" class="query03">
									</div>
								</div>
							</div>
						</div>
					</div>
					<label for="graph-2_02" class="next"><div class="arrow">&#10097;</div></label>
				</div>
				<input type="radio" name="radio-btn02" id="graph-2_02" />
				<div id="graph_02_02" class="graph">
					<label for="graph-1_02" class="prev"><div class="arrow">&#10096;</div></label>
					<div class="containerChart">
						<div class="titleChart">Results read per query</div>
						<div class="torChart">
							<div class="circle">
								<div class="source1">
									<div title="Query01 :&#10;65% read" class="s1"></div>
								</div>
								<div class="source2">
									<div title="Query02 :&#10;35% read" class="s2"></div>
								</div>
								<div class="source3">
									<div title="Query03 :&#10;15% read" class="s3"></div>
								</div>
								<div class="source4">
									<div title="Query04 :&#10;20% read" class="s4"></div>
								</div>
							</div>
							<div class="center"></div>
						</div>
					</div>
					<label for="graph-0_02" class="next"><div class="arrow">&#10097;</div></label>
				</div>
			</div>
		</div>

		<div class="communicationResults">
			<h2>Communication of results</h2>
			<div class="divRow">
				<div>
					<p>
						<h3>Your email</h3>
						<input type="email" name="email" id="email" value="<?php echo $userSettings['email']; ?>"/>
					</p>
					<h3>Result page</h3>
					<p>
						Background <select class="selectCommResult" name="backgroundResult">
						<?php
						foreach ($backgroundList as $backgroundName)
						{
							if ($userSettings['background_result'] == $backgroundName['name'])
							{
								$backgroundSelected = 'selected';
							}
							else
							{
								$backgroundSelected = '';
							}

							echo '<option value="' . $backgroundName['name'] . '" ' . $backgroundSelected . '>' . $backgroundName['name'] . '</option>';
						}
						?>
							<option value="random">Random</option>
						</select>
						<span class="arrDown">▾</span>
					</p>
				</div>
				<div>
					<h3>Sending condition</h3>
					<p>
						<input type="radio" id="condNbLink" name="cond" value="link_limit" <?php echo $condNbLink; ?>>
						<label class="radio" for="condNbLink"></label>
						by number of links :
						<input class="number alpha" type="number" name="numberLinks" min="5" placeholder="50" value="<?php echo $userSettings['link_limit']; ?>"/>
					</p>
					<p>
						<input type="radio" id="condFreq" name="cond" value="freq" <?php echo $condFreq; ?>>
						<label class="radio" for="condFreq"></label>
						by frequency, every
						<input class="number alpha" type="number" name="freq" min="2" max="500" step="2" placeholder="24" value="<?php echo $userSettings['frequency']; ?>"/> hours
					</p>
					<p>
						<input type="radio" id="condDate" name="cond" value="deadline" <?php echo $condDate; ?>>
						<label class="radio" for="condDate"></label>
						at
						<input class="number alpha" type="number" name="hours" min="0" max="23" step="2" placeholder="19" value="<?php echo $userSettings['selected_hour']; ?>"/> h
						, every
						<select class="selectCommResult" name="days">
							<option value=",1,2,3,4,5," <?php echo $day[0]; ?>>business day</option>
							<option value=",1,3,5," <?php echo $day[8]; ?>>second business day</option>
							<option value=",1,2,3,4,5,6,7," <?php echo $day[9]; ?>>day</option>
							<option value=",1," <?php echo $day[1]; ?>>monday</option>
							<option value=",2," <?php echo $day[2]; ?>>tuesday</option>
							<option value=",3," <?php echo $day[3]; ?>>wednesday</option>
							<option value=",4," <?php echo $day[4]; ?>>thursday</option>
							<option value=",5," <?php echo $day[5]; ?>>friday</option>
							<option value=",6," <?php echo $day[6]; ?>>saturday</option>
							<option value=",7," <?php echo $day[7]; ?>>sunday</option>
						</select>
						<span class="arrDown">▾</span>
						and
						<select class="selectCommResult" name="secondDay">
							<option value="">that's all</option>
							<option value="1," <?php echo $day2[1]; ?>>monday</option>
							<option value="2," <?php echo $day2[2]; ?>>tuesday</option>
							<option value="3," <?php echo $day2[3]; ?>>wednesday</option>
							<option value="4," <?php echo $day2[4]; ?>>thursday</option>
							<option value="5," <?php echo $day2[5]; ?>>friday</option>
							<option value="6," <?php echo $day2[6]; ?>>saturday</option>
							<option value="7," <?php echo $day2[7]; ?>>sunday</option>
						</select>
						<span class="arrDown">▾</span>
					</p>
				</div>
				<div>
					<h3>Sorting for links in email</h3>
					<p>
						<input type="radio" id="orderByKeyword" name="orderBy" value="masterword" <?php echo $orderByKeyword; ?>>
						<label class="radio" for="orderByKeyword"></label>
						by keyword
					</p>
					<p>
						<input type="radio" id="orderBySource" name="orderBy" value="origin" <?php echo $orderBySource; ?>>
						<label class="radio" for="orderBySource"></label>
						by source
					</p>
					<p>
						<input type="radio" id="orderByAlpha" name="orderBy" value="type" <?php echo $orderByType; ?>>
						<label class="radio" for="orderByAlpha"></label>
						by alphabetical order
					</p>
				</div>
				<div>
					<h3>Privacy</h3>
					<div class="align">
						<label class="switch">
							<input type="checkbox" name="recordRead" value="active" <?php echo $recordRead; ?>>
							<div class="slider"></div>
						</label>
						Record when a link is clicked
					</div>
					<div>
						<h3></h3>
						<div class="deleteContainer">
							<div class="deleteLogo"></div>
							<input alt="Delete" title="Delete" class="deleteButton" type="submit" name="buttonDeleteHistory" value="deleteHistory" />
							the last&nbsp;
							<input class="number alpha" name="deleteHistoryValue" type="number" min="1" value="1"/>
							&nbsp;
							<select class="selectCommResult Unit" name="deleteHistoryUnit">
								<option value="hour">Hour</option>
								<option value="day">Day</option>
								<option value="week">Week</option>
								<option value="month">Month</option>
								<option value="year">Year</option>
							</select>
							<span class="arrDown">▾</span>
						</div>
					</div>
				</div>
			</div>
			<div class="centerSubmit">
				<input title="Submit settings" class="submit" type="submit" name="settings" value="ChangeSettings" />
			</div>
		</div>

		<div class="keywordManagement">
			<h2>News management</h2>
			<div class="newsInput">
				<input title="Add new keyword" class="submit" type="submit" value="" />
				<select name="sourceKeyword" id="sourceKeyword">
					<?php
					foreach ($reqReadOwnerSourcestmp as $ownerSourcesList)
					{
						if ($ownerSourcesList['id'] == $_SESSION['lastSourceUse'])
						{
							$amISelected = 'selected';
						}
						else
						{
							$amISelected = '';
						}

						$ownerSourcesList['name'] = preg_replace("/\[!NEW!\]/", "", $ownerSourcesList['name']);
						echo '<option value="source' . $ownerSourcesList['id'] . '" ' . $amISelected . '>' . $ownerSourcesList['name'] . '</option>' . PHP_EOL;
					}
					?>
					<option value="source00">All sources</option>
				</select>
				<span class="arrDownBorder">▾</span>
				<input type="text" class="keywordInput" name="newKeyword" id="keyword" placeholder="Keyword,next keyword, ..." />
			</div>
			<div class="newsInput">
				<input alt="Add new source" title="Add" class="submit" type="submit" value="" />
				<select name="sourceType" id="sourceKeyword">
					<option value="inputSource">Add my own source</option>
					<option value="sourceGeneralEN">General news source pack [English]</option>
					<option value="sourceTechnologyEN">Technology source pack [English]</option>
					<option value="sourceSpatialEN">Spatial source pack [English]</option>
					<option value="sourceGeneralFR">General news source pack [French]</option>
					<option value="sourceTechnologyFR">Technology source pack [French]</option>
					<option value="sourceSpacialFR">Spatial source pack [French]</option>
				</select>
				<span class="arrDownBorder">▾</span>
				<input type="url" name="newSource" id="source" placeholder="Source" size="30" />
			</div>
			<?php echo $ERROR_MESSAGE; ?>

			<div class="inlineButton">
				<a class="buttonCreatesourcePack" href="sourcePack?action=creation">Create my own source pack</a>
				<a class="buttonVisiteCommunitySourcePack" href="sourcePack?action=visite">Add community source pack</a>
			</div>

			<div>
				<?php
				$cptSource = 0;
				foreach ($reqReadOwnerSourcestmp as $ownerSourcesList)
				{
					$ownerSourcesList['name'] = preg_replace("/\[!NEW!\]/", "", $ownerSourcesList['name']);
					preg_match("/./", ucfirst($ownerSourcesList['name']), $rssFirstLetter);

					if ($actualLetter != $rssFirstLetter[0])
					{
						$foldSourceName = 'radio-s' . $rssFirstLetter[0];
						$amICheckFoldSource = '';
						if (isset($_SESSION[$foldSourceName]))
						{
							if ($_SESSION[$foldSourceName] == $rssFirstLetter[0])
							{
								$amICheckFoldSource = 'checked';
							}
						}

						$actualLetter = $rssFirstLetter[0];

						echo '
						</div>
						<input type="checkbox" name="radio-s' . $rssFirstLetter[0] . '" id="unfold-s' . $rssFirstLetter[0] . '" value="' . $rssFirstLetter[0] . '" ' . $amICheckFoldSource . '/>'.
						'<div class="sourceList" >'.
							'<label for="unfold-s' . $rssFirstLetter[0] . '" class="unfoldTag">'.
								$rssFirstLetter[0] . ' ▾'.
							'</label>'.
							'<label for="unfold-s' . $rssFirstLetter[0] . '" class="foldTag">'.
								$rssFirstLetter[0] . ' ▴'.
							'</label>';
					}

					$foldKeywordName = 'radio-ks' . $ownerSourcesList['id'];
					$amICheckFoldKeyword = '';
					if (isset($_SESSION[$foldKeywordName]))
					{
						if ($_SESSION[$foldKeywordName] == $ownerSourcesList['id'])
						{
							$amICheckFoldKeyword = 'checked';
						}
					}

					if (preg_match("/," . $_SESSION['id'] . ",/", $ownerSourcesList['owners']))
					{
						echo
						'<div class="tagSource Tactive" id="ks' . $ownerSourcesList['id'] . '">'.
							'<input type="submit" title="Delete" name="delSource" value="source' . $ownerSourcesList['id'] . '&"/>'.
							'<input type="submit" title="Disable" name="disableSource" value="source' . $ownerSourcesList['id']. '&"/>'.
							'<a href="' . $ownerSourcesList['link']. '" target="_blank">'.
								ucfirst($ownerSourcesList['name']).
							'</a>'.
						'</div>';
					}
					elseif (preg_match("/,!" . $_SESSION['id'] . ",/", $ownerSourcesList['owners']))
					{
						echo
						'<div class="tagSource Tdisable" id="ks' . $ownerSourcesList['id'] . '">'.
							'<input type="submit" title="Delete" name="delSource" value="source' . $ownerSourcesList['id'] . '&"/>'.
							'<input type="submit" title="Activate" name="activateSource" value="source' . $ownerSourcesList['id']. '&"/>'.
							'<a href="' . $ownerSourcesList['link']. '" target="_blank">'.
								ucfirst($ownerSourcesList['name']).
							'</a>'.
						'</div>';
					}

					echo
					'<input type="checkbox" name="radio-ks' . $ownerSourcesList['id'] . '" id="unfold-ks' . $ownerSourcesList['id'] . '" value="' . $ownerSourcesList['id'] . '" ' . $amICheckFoldKeyword . '/>'.
					'<div class="keywordList" id="keywordList' . $ownerSourcesList['id'] . '">'.
						'<label for="unfold-ks' . $ownerSourcesList['id'] . '" id="unfold' . $ownerSourcesList['id'] . '"  class="unfoldTag">'.
							'Unfold keyword list ▾'.
						'</label>'.
						'<label for="unfold-ks' . $ownerSourcesList['id'] . '" id="fold' . $ownerSourcesList['id'] . '" class="foldTag">'.
							'Fold keyword list ▴'.
						'</label>';

					# Keyword loop
					$cptKeyword = 0;
					foreach ($reqReadOwnerSourcesKeywordtmp as $ownerKeywordList)
					{
						$applicable_owners_sources = $ownerKeywordList['applicable_owners_sources'];
						$ownerKeywordList['keyword'] = preg_replace("/^:all@[0-9]+$/", ":All", $ownerKeywordList['keyword']);
						if (preg_match("/\|" . $_SESSION['id'] . ":[,!0-9,]*," . $ownerSourcesList['id'] . ",[,!0-9,]*\|/", $applicable_owners_sources))
						{
							echo
							'<div class="tag Tactive">'.
								'<input type="submit" title="Delete" name="delKeyword" value="source'. $ownerSourcesList['id'] . '&keyword' . $ownerKeywordList['id'] . '&"/>'.
								'<input type="submit" title="Disable" name="disableKeyword" value="source'. $ownerSourcesList['id'] . '&keyword' . $ownerKeywordList['id'] . '&"/>'.
								'<a href="setting?keyword=keyword' . $ownerKeywordList['id'] . '">'.
									ucfirst($ownerKeywordList['keyword']).
								'</a>'.
							'</div>';
							$cptKeyword++;
						}
						elseif (preg_match("/\|" . $_SESSION['id'] . ":[,!0-9,]*,!" . $ownerSourcesList['id'] . ",[,!0-9,]*\|/", $applicable_owners_sources))
						{
							echo
							'<div class="tag Tdisable">'.
								'<input type="submit" title="Delete" name="delKeyword" value="source'. $ownerSourcesList['id'] . '&keyword' . $ownerKeywordList['id'] . '&"/>'.
								'<input type="submit" title="Activate" name="activateKeyword" value="source'. $ownerSourcesList['id'] . '&keyword' . $ownerKeywordList['id'] . '&"/>'.
								'<a href="setting?keyword=keyword' . $ownerKeywordList['id'] . '">'.
									ucfirst($ownerKeywordList['keyword']).
								'</a>'.
							'</div>';
							$cptKeyword++;
						}
					}
					echo '</div>' . PHP_EOL;

					if ($cptKeyword < 7)
					{
						$style = $style . PHP_EOL .
						'#unfold' . $ownerSourcesList['id'] . ',' . PHP_EOL .
						'#fold' . $ownerSourcesList['id'] . PHP_EOL .
						'{' . PHP_EOL .
						'	display: none;' . PHP_EOL .
						'}' . PHP_EOL .
						'#keywordList' . $ownerSourcesList['id'] . PHP_EOL .
						'{' . PHP_EOL .
						'	width: 96%;' . PHP_EOL .
						'	height: auto;' . PHP_EOL .
						'}' . PHP_EOL;
					}
					$cptSource++;
				}
				?>
			</div>
		</div>

<?php
	echo
	'<style>' . PHP_EOL .
	$style .
	'</style>' . PHP_EOL;
?>

		<div class="scientificPublicationManagement">
			<h2>Science watch management</h2>
			<div class="newQueryContainer">
				<input title="Add new science query" class="submit" type="submit" name="scienceQuerySubmit" value="add" />
				<input type="checkbox" id="openParenthesis0" name="openParenthesis0" value="active" />
				<label class="queryParenthesis" for="openParenthesis0">(</label>
				<select title="Type" class="queryType" name="scienceType0" id="scienceType00">
					<option value="ti">Title</option>
					<option value="au">Author</option>
					<option value="abs">Abstract</option>
					<option value="jr">Reference</option>
					<option value="cat">Category</option>
					<option value="all">All</option>
				</select>
				<span class="arrDownBorder">▾</span>
				<input type="text" class="query" name="scienceQuery0" id="scienceQuery00" placeholder="Keyword" size="30" />
				<input type="checkbox" id="closeParenthesis0" name="openParenthesis0" value="active" />
				<label class="queryParenthesis" for="closeParenthesis0">)</label>
				<div class="btnList">
					<input type="radio" id="andOrNotand_AND00" name="andOrAndnot0" value="AND">
					<label class="ANDOrNotand" for="andOrNotand_AND00"></label>
					<input type="radio" id="andOrNotand_OR00" name="andOrAndnot0" value="OR" checked>
					<label class="andORNotand" for="andOrNotand_OR00"></label>
					<input type="radio" id="andOrNotand_NOTAND00" name="andOrAndnot0" value="NOTAND">
					<label class="andOrNOTAND" for="andOrNotand_NOTAND00"></label>
				</div>
				<input type="checkbox" id="openParenthesis1" name="openParenthesis1" value="active" checked/>
				<label class="queryParenthesis" for="openParenthesis1">(</label>
				<select alt="Type" title="Type" class="queryType" name="scienceType1" id="scienceType01">
					<option value="ti">Title</option>
					<option value="au">Author</option>
					<option value="abs">Abstract</option>
					<option value="jr">Reference</option>
					<option value="cat">Category</option>
					<option value="all">All</option>
				</select>
				<span class="arrDownBorder">▾</span>
				<input type="text" class="query" name="scienceQuery1" id="scienceQuery01" placeholder="Keyword" size="30" />
				<input type="checkbox" id="closeParenthesis1" name="closeParenthesis1" value="active" />
				<label class="queryParenthesis" for="closeParenthesis1">)</label>
				<div class="btnList">
					<input type="radio" id="andOrNotand_AND01" name="andOrAndnot1" value="AND">
					<label class="ANDOrNotand" for="andOrNotand_AND01"></label>
					<input type="radio" id="andOrNotand_OR01" name="andOrAndnot1" value="OR" checked>
					<label class="andORNotand" for="andOrNotand_OR01"></label>
					<input type="radio" id="andOrNotand_NOTAND01" name="andOrAndnot1" value="NOTAND">
					<label class="andOrNOTAND" for="andOrNotand_NOTAND01"></label>
				</div>
				<input type="checkbox" id="openParenthesis2" name="openParenthesis2" value="active" />
				<label class="queryParenthesis" for="openParenthesis2">(</label>
				<select alt="Type" title="Type" class="queryType" name="scienceType2" id="scienceType02">
					<option value="ti">Title</option>
					<option value="au">Author</option>
					<option value="abs">Abstract</option>
					<option value="jr">Reference</option>
					<option value="cat">Category</option>
					<option value="all">All</option>
				</select>
				<span class="arrDownBorder">▾</span>
				<input type="text" class="query" name="scienceQuery2" id="scienceQuery02" placeholder="Keyword" size="30" />
				<input type="checkbox" id="closeParenthesis2" name="closeParenthesis2" value="active" checked/>
				<label class="queryParenthesis" for="closeParenthesis2">)</label>
				<input alt="Extend" title="Extend" class="extend" type="submit" id="extendScience" name="extendScience" value=">>" />
			</div>
			<?php echo $ERROR_SCIENCEQUERY; ?>
			<div class="queryContainer">
				<a title="Delete" class="deleteQuery" href="setting?action=deleteQueryScience&query=0" ></a>
				<a title="Disable" class="disableQuery" href="setting?action=disableQueryScience&query=0" ></a>
				<?php
				$queryFieldsName['ti']  = 'Title';
				$queryFieldsName['au']  = 'Author';
				$queryFieldsName['abs'] = 'Abstract';
				$queryFieldsName['cat'] = 'Category';
				$queryFieldsName['jr']  = 'Reference';
				$queryFieldsName['all'] = 'All';

				$query = 'ti:%22artificial+intelligence%22+AND+%28abs:%22genetic%22+AND+abs:%22algorithm%22%29';

				$query = preg_replace("/%22/", "`", $query);
				$query = preg_replace("/%28/", "(", $query);
				$query = preg_replace("/%29/", ")", $query);

				preg_match_all("/[a-z]+:/", $query, $queryFields);
				foreach ($queryFields[0] as $fields)
				{
					preg_match("/^\(/", $query, $openParenthesisDisplay);
					if (!empty($openParenthesisDisplay[0]))
					{
						$query = preg_replace("/^\(/", "", $query);
						$queryDisplay = $queryDisplay . '
						<a href="setting?action=editQueryScience&query=0" >
							<div class="queryParenthesisView">(</div>
						</a>
						';
					}

					preg_match("/$fields`[^`]*`/", $query, $fieldInput);
					$fieldInputPURE = preg_replace("/\+/", "\+", $fieldInput[0]);
					$query = preg_replace("/$fieldInputPURE/", "", $query);
					$fieldInput = preg_replace("/(.+:|`)/", "", $fieldInput[0]);
					$fieldInput = preg_replace("/\+/", " ", $fieldInput);
					$fields = preg_replace("/(:|`)/", "", $fields);
					$queryDisplay = $queryDisplay . '
					<a href="setting?action=editQueryScience&query=0" >
						<div class="queryTypeView">' . $queryFieldsName[$fields] . '</div>
					</a>
					<a href="setting?action=editQueryScience&query=0" >
						<div class="queryKeywordView">' . $fieldInput . '</div>
					</a>';

					preg_match("/^\)/", $query, $closeParenthesisDisplay);
					if (!empty($closeParenthesisDisplay[0]))
					{
						$query = preg_replace("/^\)/", "", $query);
						$queryDisplay = $queryDisplay . '
						<a href="setting?action=editQueryScience&query=0" >
							<div class="queryParenthesisView">)</div>
						</a>
						';
					}

					preg_match("/^\+(AND|OR|NOTAND)\+/", $query, $logicalConnector);
					if (!empty($logicalConnector[1]))
					{
						$query = preg_replace("/^\+(AND|OR|NOTAND)\+/", "", $query);
						$queryDisplay = $queryDisplay . '
						<a href="setting?action=editQueryScience&query=0" >
						<div class="query' . ucfirst(strtolower($logicalConnector[1])) . 'View">' . $logicalConnector[1] . '</div>
						</a>
						';
					}
				}

				echo $queryDisplay;
				?>
			</div>
			<div class="queryContainer">
				<a title="Delete" class="deleteQuery" href="setting?action=deleteQueryScience&query=1" ></a>
				<a title="Disable" class="disableQuery" href="setting?action=disableQueryScience&query=1" ></a>
				<a href="setting?action=editQueryScience&query=1" >
					<div class="queryTypeView">Author</div>
				</a>
				<a href="setting?action=editQueryScience&query=1" >
					<div class="queryKeywordView">Pr Chen</div>
				</a>
				<a href="setting?action=editQueryScience&query=1" >
					<div class="queryOrView">OR</div>
				</a>
				<a href="setting?action=editQueryScience&query=1" >
					<div class="queryTypeView">Title</div>
				</a>
				<a href="setting?action=editQueryScience&query=1" >
					<div class="queryKeywordView">Pokemon</div>
				</a>
				<a href="setting?action=editQueryScience&query=1" >
					<div class="queryAndView">AND</div>
				</a>
				<a href="setting?action=editQueryScience&query=1" >
					<div class="queryTypeView">Title</div>
				</a>
				<a href="setting?action=editQueryScience&query=1" >
					<div class="queryKeywordView">Pika</div>
				</a>
				<a href="setting?action=editQueryScience&query=1" >
					<div class="queryAndView">AND</div>
				</a>
				<a href="setting?action=editQueryScience&query=1" >
					<div class="queryTypeView">Abstract</div>
				</a>
				<a href="setting?action=editQueryScience&query=1" >
					<div class="queryKeywordView">Joel</div>
				</a>
				<a href="setting?action=editQueryScience&query=1" >
					<div class="queryNotView">NOT</div>
				</a>
				<a href="setting?action=editQueryScience&query=1" >
					<div class="queryTypeView">English abstract</div>
				</a>
				<a href="setting?action=editQueryScience&query=1" >
					<div class="queryKeywordView">Sacha</div>
				</a>
			</div>
			<div class="queryContainer">
				<a title="Delete" class="deleteQuery" href="setting?action=deleteQueryScience&query=2" ></a>
				<a title="Disable" class="disableQuery" href="setting?action=disableQueryScience&query=2" ></a>
				<a href="setting?action=editQueryScience&query=2" >
					<div class="queryTypeView">Author</div>
				</a>
				<a href="setting?action=editQueryScience&query=2" >
					<div class="queryKeywordView">Ruffy67</div>
				</a>
				<a href="setting?action=editQueryScience&query=2" >
					<div class="queryAndView">AND</div>
				</a>
				<a href="setting?action=editQueryScience&query=2" >
					<div class="queryTypeView">English abstract</div>
				</a>
				<a href="setting?action=editQueryScience&query=2" >
					<div class="queryKeywordView">test</div>
				</a>
				<a href="setting?action=editQueryScience&query=2" >
					<div class="queryNotView">NOT</div>
				</a>
				<a href="setting?action=editQueryScience&query=2" >
					<div class="queryTypeView">English title</div>
				</a>
				<a href="setting?action=editQueryScience&query=2" >
					<div class="queryKeywordView">test2</div>
				</a>
			</div>
			<div class="queryContainer">
				<a title="Delete" class="deleteQuery" href="setting?action=deleteQueryScience&query=3" ></a>
				<a title="Disable" class="disableQuery" href="setting?action=disableQueryScience&query=3" ></a>
				<div class="queryTypeView">Title</div>
				<div class="queryKeywordView">RoboJo</div>
				<div class="queryAndView">AND</div>
				<div class="queryTypeView">Abstract</div>
				<div class="queryKeywordView">Pied en canard</div>
				<div class="queryNotView">NOT</div>
				<div class="queryTypeView">Title</div>
				<div class="queryKeywordView">Jo le taxi</div>
			</div>
			<div class="queryContainer Qdisable">
				<a title="Delete" class="deleteQuery" href="setting?action=deleteQueryScience&query=4" ></a>
				<a title="Activate" class="activateQuery" href="setting?action=activeQueryScience&query=4" ></a>
				<div class="queryTypeView">Title</div>
				<div class="queryKeywordView">RoboJo</div>
				<div class="queryAndView">AND</div>
				<div class="queryTypeView">Abstract</div>
				<div class="queryKeywordView">Pied en canard</div>
				<div class="queryNotView">NOT</div>
				<div class="queryTypeView">Title</div>
				<div class="queryKeywordView">Jo le taxi</div>
			</div>
			<div class="queryContainer Qdisable">
				<a title="Delete" class="deleteQuery" href="setting?action=deleteQueryScience&query=5" ></a>
				<a title="Activate" class="activateQuery" href="setting?action=activeQueryScience&query=5" ></a>
				<div class="queryTypeView">Title</div>
				<div class="queryKeywordView">Mister Robot</div>
				<div class="queryNotView">NOT</div>
				<div class="queryTypeView">Abstract</div>
				<div class="queryKeywordView">Ours</div>
			</div>
		</div>
		<div class="patentManagement">
			<h2>Patent watch management</h2>
			<div class="newQueryContainer">
				<input alt="Add" title="Add" class="submit" type="submit" value="" />
				<select alt="Type" title="Type" class="queryType" name="patentType00" id="patentType00">
					<option value="EN_TI">English title</option>
					<option value="EN_AB">English abstract</option>
					<option value="IN">Inventor</option>
				</select>
				<span class="arrDownBorder">▾</span>
				<input type="text" class="query" name="patentQuery00" id="patentQuery00" placeholder="Keyword" size="30" />
				<input type="checkbox" id="patentAndOr1">
				<label class="andOr" for="patentAndOr1"></label>
				<select alt="Type" title="Type" class="queryType" name="patentType01" id="patentType01">
					<option value="EN_TI">English title</option>
					<option value="EN_AB">English abstract</option>
					<option value="IN">Inventor</option>
				</select>
				<span class="arrDownBorder">▾</span>
				<input type="text" class="query" name="patentQuery01" id="patentQuery01" placeholder="Keyword" size="30" />
				<input type="checkbox" id="patentAndOr2">
				<label class="andOr" for="patentAndOr2"></label>
				<select alt="Type" title="Type" class="queryType" name="patentType02" id="patentType02">
					<option value="EN_TI">English title</option>
					<option value="EN_AB">English abstract</option>
					<option value="IN">Inventor</option>
				</select>
				<span class="arrDownBorder">▾</span>
				<input type="text" class="query" name="patentQuery02" id="patentQuery02" placeholder="Keyword" size="30" />
				<input alt="Extend" title="Extend" class="extend" type="submit" id="extend" name="extend" value=">>" />
			</div>
			<div class="queryContainer">
				<a title="Delete" class="deleteQuery" href="setting?action=deleteQueryPatent&query=0" ></a>
				<a title="Disable" class="disableQuery" href="setting?action=disableQueryPatent&query=0" ></a>
				<div class="queryTypeView">Inventor</div>
				<div class="queryKeywordView">Gintoki</div>
				<div class="queryAndView">AND</div>
				<div class="queryTypeView">English title</div>
				<div class="queryKeywordView">Wooden computer</div>
				<div class="queryOrView">OR</div>
				<div class="queryTypeView">English title</div>
				<div class="queryKeywordView">Wooden electronics</div>
			</div>
			<div class="queryContainer">
				<a title="Delete" class="deleteQuery" href="setting?action=deleteQueryPatent&query=1" ></a>
				<a title="Disable" class="disableQuery" href="setting?action=disableQueryPatent&query=1" ></a>
				<div class="queryTypeView">Inventor</div>
				<div class="queryKeywordView">Pr Chen</div>
				<div class="queryOrView">OR</div>
				<div class="queryTypeView">English title</div>
				<div class="queryKeywordView">Pokemon</div>
				<div class="queryAndView">AND</div>
				<div class="queryTypeView">English title</div>
				<div class="queryKeywordView">Pika</div>
				<div class="queryAndView">AND</div>
				<div class="queryTypeView">English abstract</div>
				<div class="queryKeywordView">Joel</div>
				<div class="queryOrView">OR</div>
				<div class="queryTypeView">English abstract</div>
				<div class="queryKeywordView">Sacha</div>
			</div>
			<div class="queryContainer">
				<a title="Delete" class="deleteQuery" href="setting?action=deleteQueryPatent&query=2" ></a>
				<a title="Disable" class="disableQuery" href="setting?action=disableQueryPatent&query=2" ></a>
				<div class="queryTypeView">Inventor</div>
				<div class="queryKeywordView">Ruffy67</div>
				<div class="queryAndView">AND</div>
				<div class="queryTypeView">English abstract</div>
				<div class="queryKeywordView">test</div>
				<div class="queryAndView">AND</div>
				<div class="queryTypeView">English title</div>
				<div class="queryKeywordView">test2</div>
			</div>
			<div class="queryContainer">
				<a title="Delete" class="deleteQuery" href="setting?action=deleteQueryPatent&query=3" ></a>
				<a title="Disable" class="disableQuery" href="setting?action=disableQueryPatent&query=3" ></a>
				<div class="queryTypeView">English title</div>
				<div class="queryKeywordView">RoboJo</div>
				<div class="queryAndView">AND</div>
				<div class="queryTypeView">English abstract</div>
				<div class="queryKeywordView">Pied en canard</div>
				<div class="queryOrView">OR</div>
				<div class="queryTypeView">English title</div>
				<div class="queryKeywordView">Jo le taxi</div>
				<div class="queryAndView">AND</div>
				<div class="queryTypeView">English abstract</div>
				<div class="queryKeywordView">Dermiste</div>
			</div>
			<div class="queryContainer">
				<a title="Delete" class="deleteQuery" href="setting?action=deleteQueryPatent&query=4" ></a>
				<a title="Disable" class="disableQuery" href="setting?action=disableQueryPatent&query=4" ></a>
				<div class="queryTypeView">English title</div>
				<div class="queryKeywordView">RoboJo</div>
				<div class="queryAndView">AND</div>
				<div class="queryTypeView">English abstract</div>
				<div class="queryKeywordView">Pied en canard</div>
				<div class="queryOrView">OR</div>
				<div class="queryTypeView">English title</div>
				<div class="queryKeywordView">Jo le taxi</div>
			</div>
			<div class="queryContainer">
				<a title="Delete" class="deleteQuery" href="setting?action=deleteQueryPatent&query=5" ></a>
				<a title="Disable" class="disableQuery" href="setting?action=disableQueryPatent&query=5" ></a>
				<div class="queryTypeView">English title</div>
				<div class="queryKeywordView">Mister Robot</div>
				<div class="queryAndView">AND</div>
				<div class="queryTypeView">English abstract</div>
				<div class="queryKeywordView">Ours</div>
				<div class="queryOrView">OR</div>
				<div class="queryTypeView">English title</div>
				<div class="queryKeywordView">Jo le taxi</div>
			</div>
			<div class="queryContainer Qdisable">
				<a title="Delete" class="deleteQuery" href="setting?action=deleteQueryPatent&query=6" ></a>
				<a title="Activate" class="activateQuery" href="setting?action=activeQueryPatent&query=6" ></a>
				<div class="queryTypeView">English title</div>
				<div class="queryKeywordView">Cat</div>
				<div class="queryAndView">AND</div>
				<div class="queryTypeView">English abstract</div>
				<div class="queryKeywordView">animals</div>
				<div class="queryOrView">OR</div>
				<div class="queryTypeView">English title</div>
				<div class="queryKeywordView">Dog</div>
				<div class="queryAndView">AND</div>
				<div class="queryTypeView">English abstract</div>
				<div class="queryKeywordView">Canis</div>
			</div>
		</div>
	</div>
</form>
